{"componentChunkName":"component---src-templates-blog-post-js","path":"/889568539/","result":{"data":{"site":{"siteMetadata":{"title":"ssh的博客","author":"ssh"}},"markdownRemark":{"id":"2c936cb4-cd85-52e8-8161-0120ad442974","html":"<h2 id=\"知乎官宣\"><a href=\"#%E7%9F%A5%E4%B9%8E%E5%AE%98%E5%AE%A3\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>知乎官宣</h2>\n<p>凌晨时分，尤雨溪突然在知乎上发布了一个消息，宣布 Vue3 将不再支持 IE11，来通过详细的 RFC 了解一下为什么 Vue 团队做出这个决策。</p>\n<h2 id=\"原因\"><a href=\"#%E5%8E%9F%E5%9B%A0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原因</h2>\n<p>从 Vue 3 开发开始，一直到 2018 年底，我们就一直被问及 IE11 支持的问题。</p>\n<p>很多用户都问过，Vue 3 是否会支持 IE11，我们最初的计划是先发布 Vue 3，让它稳定下来，然后再增加对 IE11 的支持。</p>\n<p>在漫长的开发过程中，我们也对 IE11 的兼容性进行了<strong>研究和实验</strong>，但<strong>较高的复杂度</strong>以及手上<strong>繁多的工作</strong>，让我们不得不<strong>推迟它的优先级</strong>。</p>\n<p>当时间来到 2021 年，我们重新审视这个问题时，浏览器和 JavaScript 已经发生了很大的变化。</p>\n<p>越来越多的开发人员开始使用更现代的语言特性，更重要的是，<a href=\"https://techcommunity.microsoft.com/t5/windows-it-pro-blog/the-perils-of-using-internet-explorer-as-your-default-browser/ba-p/331732\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">微软自己也开始通过对 Edge 的投资，积极推动用户远离 IE</a>。</p>\n<p><a href=\"https://techcommunity.microsoft.com/t5/microsoft-365-blog/microsoft-365-apps-say-farewell-to-internet-explorer-11-and/ba-p/1591666\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">它还在自己的主要项目(如微软 365)中放弃了对 IE11 的支持</a>。</p>\n<p>就在几天前，<a href=\"https://make.wordpress.org/core/2021/03/25/discussion-summary-dropping-support-for-ie11/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WordPress 也决定放弃对 IE11 的支持</a>。</p>\n<p>IE11 的全球使用率已经<a href=\"https://caniuse.com/usage-table\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">降至 1%以下</a>。</p>\n<p>当我们谈论面向公众的网站和应用程序时，IE11 正在明显快速下滑。</p>\n<p>已经到了重新考虑 Vue3 对 IE11 支持的时机了。</p>\n<h2 id=\"在-vue3-中支持-ie11，代价如何？\"><a href=\"#%E5%9C%A8-vue3-%E4%B8%AD%E6%94%AF%E6%8C%81-ie11%EF%BC%8C%E4%BB%A3%E4%BB%B7%E5%A6%82%E4%BD%95%EF%BC%9F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>在 Vue3 中支持 IE11，代价如何？</h2>\n<h3 id=\"行为不一致\"><a href=\"#%E8%A1%8C%E4%B8%BA%E4%B8%8D%E4%B8%80%E8%87%B4\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>行为不一致</h3>\n<p>Vue 2 的响应式系统是基于 ES5 getter/setters 的。</p>\n<p>Vue 3 利用 ES2015 Proxy 提供了一个性能更好、更加完善的响应式系统，而 IE11 无法 polyfill 这些特性。</p>\n<p>这是主要的障碍，因为这意味着 Vue 3 要支持 IE11，它本质上需要发布<strong>两个具有不同行为的版本</strong>：一个使用基于 Proxy 的响应式系统，另一个使用类似于 Vue 2 的基于 ES5 getter/setters 的版本。</p>\n<p>Vue 3 基于 Proxy 的响应式系统提供了<strong>近乎完整</strong>的语言特性覆盖。</p>\n<p>它能够检测到许多在 ES5 中不敢想象的操作，例如属性的添加/删除、数组索引和长度突变，以及 <code class=\"language-text\">in</code> 操作符的拦截。</p>\n<p>为 Vue 3 的 Proxy 版本编写的应用<strong>肯定不能在 IE11 版本中工作</strong>。这不仅给我们带来了技术上的复杂性，也给开发人员带来了持续的精神负担。</p>\n<p>我们最初的计划是在 IE11 版本的开发构建中<strong>同时发布 Proxy 和 ES5 的两种响应性版本</strong>。</p>\n<p>当它在支持 Proxy 的开发环境中运行时，会<strong>检测并警告</strong>不兼容 ie11 的一些用法。理论上可行，但是复杂度巨大，因为它需要将两种实现混合在一起，并且有可能导致<strong>开发和生产之间的行为差异</strong>。</p>\n<h3 id=\"长期维护的负担\"><a href=\"#%E9%95%BF%E6%9C%9F%E7%BB%B4%E6%8A%A4%E7%9A%84%E8%B4%9F%E6%8B%85\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>长期维护的负担</h3>\n<p>支持 IE11 也意味着我们必须考虑在整个代码库中使用的语言特性，并为我们的发布版本找到合适的 poliyfill / 编译策略。</p>\n<p>每一个不能在 IE11 中被 polyfill 的新特性都会带来新的行为警告。一旦 Vue 3 承诺支持 IE11，就永远没办法摆脱了，直到下一个大版本。</p>\n<h3 id=\"给库作者带来的复杂度\"><a href=\"#%E7%BB%99%E5%BA%93%E4%BD%9C%E8%80%85%E5%B8%A6%E6%9D%A5%E7%9A%84%E5%A4%8D%E6%9D%82%E5%BA%A6\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>给库作者带来的复杂度</h3>\n<p>如果 Vue 本身可以完全覆盖掉这些复杂度，那么一定程度上我们还是可以接受的。然而，在与社区成员讨论后，我们意识到共存的两个响应性实现也不可避免地<strong>影响库作者的开发</strong>。</p>\n<p>通过在 Vue 3 中支持 IE11，库作者本质上也需要同样做一些决定。库作者不得不考虑他们的库<strong>使用的是哪种 Vue 3 版本</strong>(可能还支持 Vue 2)。如果他们决定支持 IE11，他们在编写库时，脑子里也必须<strong>时刻考虑 ES5 响应式系统的一些缺陷</strong>。</p>\n<h3 id=\"为-ie11-持续存在做贡献\"><a href=\"#%E4%B8%BA-ie11-%E6%8C%81%E7%BB%AD%E5%AD%98%E5%9C%A8%E5%81%9A%E8%B4%A1%E7%8C%AE\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>为 IE11 持续存在做贡献</h3>\n<p><strong>没有人想支持 IE11</strong>。它是一个<strong>死气沉沉的浏览器</strong>，停留在过去。Web 生态系统向前发展得越远，我们在尝试支持它时，需要填补的缺口就越大。讽刺的是，通过在 Vue 3 中支持 IE11，我们给了它<strong>更多的生命力</strong>。考虑到我们的用户基础，放弃对 IE11 的支持可能会让它<strong>更快地被淘汰</strong>。</p>\n<h2 id=\"对于那些实在需要-ie11-支持的人\"><a href=\"#%E5%AF%B9%E4%BA%8E%E9%82%A3%E4%BA%9B%E5%AE%9E%E5%9C%A8%E9%9C%80%E8%A6%81-ie11-%E6%94%AF%E6%8C%81%E7%9A%84%E4%BA%BA\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>对于那些实在需要 IE11 支持的人</h2>\n<p>我们很清楚，对 IE11 的真正需求来自那些没办法做升级的人：金融机构、教育部门和那些依赖 IE11 作为屏幕阅读器的人。如果你正在构建一个针对这些领域的应用，你可能没有选择。</p>\n<p>如果您需要 IE11 支持，我们的建议是使用 Vue 2。与其为 Vue3 和未来的版本承担巨大的技术债，我们相信，把工作重心放在让 Vue2 <strong>拥有更多 Vue3 类似的特性</strong>更有意义，让两个版本之间的开发体验更相似。</p>\n<p>一些我们考虑带给 Vue 2.7 的功能：</p>\n<ul>\n<li>把 <a href=\"https://github.com/vuejs/composition-api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@vue/composition-api plugin</a>合并进 Vue2。这会让使用 Composition API 开发的库同时支持 Vue2 和 Vue3。</li>\n<li>单文件组件（SFC）中的<a href=\"https://github.com/vuejs/rfcs/pull/227\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">script setup</a>语法。</li>\n<li><code class=\"language-text\">emits</code> 选项。</li>\n<li>提升 TypeScript 类型支持。</li>\n<li>在 Vite 中正式支持 Vue 2(目前通过<a href=\"https://github.com/underfin/vite-plugin-vue2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">非官方插件</a>)</li>\n</ul>\n<p>注：以上列表是<strong>暂时的/不详尽</strong>的，我们最后会在单独的 RFC 中讨论/最终确定。</p>\n<h2 id=\"引用\"><a href=\"#%E5%BC%95%E7%94%A8\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>引用</h2>\n<ul>\n<li><a href=\"https://github.com/vuejs/rfcs/blob/ie11/active-rfcs/0000-vue3-ie11-support.md#for-those-who-absolutely-need-ie11-support\" title=\"RFC 原文地址\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RFC 原文地址</a></li>\n<li><a href=\"https://github.com/vuejs/rfcs/discussions/296\" title=\"社区讨论\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">社区讨论</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/362000763\" title=\"知乎中文发布\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">知乎中文发布</a></li>\n</ul>","timeToRead":6,"frontmatter":{"title":"[RFC] 关于 Vue 3 的 IE11 支持","date":"May 12, 2021","spoiler":""},"fields":{"slug":"/889568539/","langKey":"en"}}},"pageContext":{"slug":"/889568539/","previous":{"fields":{"slug":"/862643192/","langKey":"en","directoryName":"862643192"},"frontmatter":{"title":"VueConf 2021 抢先看，Evan You 和你聊聊 Vue 的未来"}},"next":null,"translations":[],"translatedLinks":[]}},"staticQueryHashes":["336482444"]}